[
  {
    "path": "posts/2020-07-06-a-first-look-at-parallel-cuhre-subregions/",
    "title": "A first look at parallel CUHRE subregions",
    "description": "A first analysis the shapes of subregions generated by the parallel CUHRE algorithm.\nWe are looking to determine whether parallel CUHRE is prone to producing very\nenlongated regions.",
    "author": [
      {
        "name": "Marc Paterno",
        "url": "https://github.com/marcpaterno"
      }
    ],
    "date": "2020-07-06",
    "categories": [],
    "contents": "\nThe integrand\nThe integrand chosen is: \\[ | \\cos(4 v +5 w + 6 x +7 y + 8 z)/k |\\] with \\(k = 0s .6371054\\). For this integrand, the normalization is approximate. The true value of the integrand is close to, but not exactly, 1.\nThe data recorded\n\n\n# Download the data if it does not already exist locally.\nif (!file.exists(\"df5.fst\")) {\n  filename <- \"genz_1abs_5d_regions.csv.xz\"\n  downloadstatus <- \n    download.file(sprintf(\"https://zenodo.org/record/4319038/files/%s\", filename),\n                  filename)\n  stopifnot(downloadstatus == 0)\n  tmp <- readr::read_csv(filename)\n  unlink(filename)\n  tmp <- as_tibble(tmp)\n  fst::write_fst(tmp, \"df5.fst\")\n  rm(tmp)\n}\n\n\n\n\n\ndf5 <- fst::read_fst(\"df5.fst\") %>%\n  mutate(vol = dim0 * dim1 * dim2 * dim3 * dim4)\n\n\n\n\n\nsummary(df5)\n\n\n     value               error                dim0         \n Min.   :0.000e+00   Min.   :0.000e+00   Min.   :0.003906  \n 1st Qu.:4.000e-11   1st Qu.:1.641e-12   1st Qu.:0.015625  \n Median :2.100e-10   Median :1.219e-11   Median :0.031250  \n Mean   :1.653e-08   Mean   :2.799e-11   Mean   :0.024985  \n 3rd Qu.:8.100e-10   3rd Qu.:4.131e-11   3rd Qu.:0.031250  \n Max.   :4.227e-05   Max.   :8.140e-10   Max.   :0.125000  \n      dim1               dim2               dim3         \n Min.   :0.003906   Min.   :0.003906   Min.   :0.003906  \n 1st Qu.:0.015625   1st Qu.:0.015625   1st Qu.:0.015625  \n Median :0.015625   Median :0.015625   Median :0.015625  \n Mean   :0.021813   Mean   :0.017782   Mean   :0.015785  \n 3rd Qu.:0.031250   3rd Qu.:0.015625   3rd Qu.:0.015625  \n Max.   :0.125000   Max.   :0.125000   Max.   :0.125000  \n      dim4               div            vol           \n Min.   :0.003906   Min.   : 0.0   Min.   :2.000e-12  \n 1st Qu.:0.007812   1st Qu.:13.0   1st Qu.:4.660e-10  \n Median :0.015625   Median :14.0   Median :1.863e-09  \n Mean   :0.014392   Mean   :14.5   Mean   :1.654e-08  \n 3rd Qu.:0.015625   3rd Qu.:16.0   3rd Qu.:3.725e-09  \n Max.   :0.125000   Max.   :24.0   Max.   :3.052e-05  \n\nVariations with div\ndiv is the number of divisions this volume has been subject to (since the start of Phase 2).\nFor this integrand, the estimated value of the integral over the subregion decreases with the number of divisions:\n\n\nggplot(df5, aes(div, value, group = div)) +\n  geom_boxplot() +\n  scale_y_log10() +\n  labs(x=\"Number of divisions for the volume\", y=\"value of integral in volume\")\n\n\n\n\nHow “stretched” are the subregions?\nWe define the quantity stretch to be the ratio of the maximum subregion extent to the minimum subregion extent. A hypercube would have a stretch of 1.\n\n\ndf5 <- mutate(df5, mind = pmin(dim0, dim1, dim2, dim3, dim4),\n            maxd = pmax(dim0, dim1, dim2, dim3, dim4),\n            stretch = maxd/mind)\n\n\n\n\n\nggplot(df5, aes(stretch)) +\n  geom_histogram(bins = 50, binwidth = 1, center = 0)\n\n\n\n\nNo region from this application of the algorithm has a stretch of more than 4. At least for this integrand, there is no sign that the algorithm is making very enlongated regions.\n\n\n\n",
    "preview": "posts/2020-07-06-a-first-look-at-parallel-cuhre-subregions/a-first-look-at-parallel-cuhre-subregions_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2020-12-12T13:31:26-06:00",
    "input_file": {}
  },
  {
    "path": "posts/2020-06-24-comparing-serial-vegas-and-cuhre-on-a-non-separable-integrand-part-2/",
    "title": "Comparing Serial VEGAS and CUHRE on a non-separable integrand, part 2",
    "description": "This document continues the comparison of the speed of the serial VEGAS and CUHRE\nalgorithms, as implemented in the CUBA (http://www.feynarts.de/cuba/) library,\nand wrapped by `cubacpp` (https://bitbucket.org/mpaterno/cubacpp), on a\nnon-separable integrand.\n\nNote this was updated on 2020-12-13.",
    "author": [
      {
        "name": "Marc Paterno",
        "url": "https://github.com/marcpaterno"
      }
    ],
    "date": "2020-06-24",
    "categories": [],
    "contents": "\nThe algorithms\nvegas is the Vegas algorithm of Lepage, as implemented in the CUBA library. This version uses quasi-random (low-descrepency sequence) numbers, rather than pseudo-random numbers. cuhre_0 is the serial CUHRE algorithm, as implemented in the CUBA library, using flag = 0. This version uses all the volumes produced by the algorithm for determining the final result. cuhre_1 is the serial CUHRE algorithm, as implemented in the CUBA library, using flag = 4. This version uses only the final set of volumes produced by the algorithm for determining the final result.\nThe integrand\nThe integrand chosen is: \\[ | \\cos(4 v +5 w + 6 x +7 y + 8 z)/k |\\] with \\(k = 0.6371054\\). For this integrand, the normalization is approximate; the true value of the integrand is close to, but not exactly, 1.\nTesting environment\nThese tests were run on a MacBook Pro laptop.\nThe MacBook machine used in these tests has a single 4-core 2.9 GHz Intel Core i7 processor.\n\nDescription of the dataframe\nalg: the name of the algorithm\nepsrel: the fractional error target\nvalue: the estimated value of the integral\nerrorest: the estimated error for the result\nerror: the absolute difference between the estimated value and the true value\nneval: the number of function evaluations used\nnregions: the number of regions used\ntime: the time in milliseconds for the calculation\nr: ratio of (errorest/(epsrel*value)); this should be less than 1 if the algorithm has converged\nconverged: boolean showing whether r < 1\nA value of NA indicates that the algorithm did not converge, but rather stopped because the maximum number of function evaluations had been reached.\n\n\n\n\n{\"columns\":[{\"label\":[\"alg\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"epsrel\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"value\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"errorest\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"neval\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"nregions\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"time\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"r\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"vegas\",\"2\":\"1.000000e-01\",\"3\":\"1.0068075\",\"4\":\"1.513129e-02\",\"5\":\"1000\",\"6\":\"-1\",\"7\":\"0.161238\",\"8\":\"0.1502898\"},{\"1\":\"cuhre_0\",\"2\":\"1.000000e-01\",\"3\":\"0.9888420\",\"4\":\"9.815985e-02\",\"5\":\"42861\",\"6\":\"79\",\"7\":\"2.070419\",\"8\":\"0.9926748\"},{\"1\":\"cuhre_1\",\"2\":\"1.000000e-01\",\"3\":\"1.0013182\",\"4\":\"1.001293e-01\",\"5\":\"6300021\",\"6\":\"11539\",\"7\":\"311.253588\",\"8\":\"0.9999753\"},{\"1\":\"vegas\",\"2\":\"5.000000e-02\",\"3\":\"1.0068075\",\"4\":\"1.513129e-02\",\"5\":\"1000\",\"6\":\"-1\",\"7\":\"0.107681\",\"8\":\"0.3005796\"},{\"1\":\"cuhre_0\",\"2\":\"5.000000e-02\",\"3\":\"1.0239457\",\"4\":\"5.103488e-02\",\"5\":\"95277\",\"6\":\"175\",\"7\":\"4.398316\",\"8\":\"0.9968279\"},{\"1\":\"cuhre_1\",\"2\":\"5.000000e-02\",\"3\":\"1.0026488\",\"4\":\"5.013147e-02\",\"5\":\"27575457\",\"6\":\"50505\",\"7\":\"2599.683250\",\"8\":\"0.9999806\"},{\"1\":\"vegas\",\"2\":\"2.500000e-02\",\"3\":\"1.0068075\",\"4\":\"1.513129e-02\",\"5\":\"1000\",\"6\":\"-1\",\"7\":\"0.109668\",\"8\":\"0.6011593\"},{\"1\":\"cuhre_0\",\"2\":\"2.500000e-02\",\"3\":\"1.0330110\",\"4\":\"2.582169e-02\",\"5\":\"220857\",\"6\":\"405\",\"7\":\"9.310356\",\"8\":\"0.9998613\"},{\"1\":\"cuhre_1\",\"2\":\"2.500000e-02\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"100000173\",\"6\":\"183151\",\"7\":\"39666.668765\",\"8\":\"NA\"},{\"1\":\"vegas\",\"2\":\"1.250000e-02\",\"3\":\"1.0092280\",\"4\":\"9.728969e-03\",\"5\":\"2500\",\"6\":\"-1\",\"7\":\"0.225131\",\"8\":\"0.7712008\"},{\"1\":\"cuhre_0\",\"2\":\"1.250000e-02\",\"3\":\"1.0202985\",\"4\":\"1.275144e-02\",\"5\":\"508599\",\"6\":\"932\",\"7\":\"21.531616\",\"8\":\"0.9998201\"},{\"1\":\"vegas\",\"2\":\"6.250000e-03\",\"3\":\"1.0046887\",\"4\":\"5.831741e-03\",\"5\":\"7000\",\"6\":\"-1\",\"7\":\"0.527211\",\"8\":\"0.9287241\"},{\"1\":\"cuhre_0\",\"2\":\"6.250000e-03\",\"3\":\"1.0175852\",\"4\":\"6.359295e-03\",\"5\":\"1038765\",\"6\":\"1903\",\"7\":\"40.627054\",\"8\":\"0.9999036\"},{\"1\":\"vegas\",\"2\":\"3.125000e-03\",\"3\":\"1.0012113\",\"4\":\"2.961637e-03\",\"5\":\"27000\",\"6\":\"-1\",\"7\":\"1.862267\",\"8\":\"0.9465771\"},{\"1\":\"cuhre_0\",\"2\":\"3.125000e-03\",\"3\":\"1.0140915\",\"4\":\"3.169008e-03\",\"5\":\"2294565\",\"6\":\"4203\",\"7\":\"87.945607\",\"8\":\"0.9999912\"},{\"1\":\"vegas\",\"2\":\"1.562500e-03\",\"3\":\"0.9987791\",\"4\":\"1.503164e-03\",\"5\":\"104500\",\"6\":\"-1\",\"7\":\"6.866261\",\"8\":\"0.9632006\"},{\"1\":\"cuhre_0\",\"2\":\"1.562500e-03\",\"3\":\"1.0076404\",\"4\":\"1.574387e-03\",\"5\":\"5064969\",\"6\":\"9277\",\"7\":\"227.468266\",\"8\":\"0.9999675\"},{\"1\":\"vegas\",\"2\":\"7.812500e-04\",\"3\":\"0.9990101\",\"4\":\"7.763180e-04\",\"5\":\"389500\",\"6\":\"-1\",\"7\":\"22.689305\",\"8\":\"0.9946717\"},{\"1\":\"cuhre_0\",\"2\":\"7.812500e-04\",\"3\":\"1.0035614\",\"4\":\"7.840280e-04\",\"5\":\"10645635\",\"6\":\"19498\",\"7\":\"607.150737\",\"8\":\"0.9999945\"},{\"1\":\"vegas\",\"2\":\"3.906250e-04\",\"3\":\"0.9992140\",\"4\":\"3.899594e-04\",\"5\":\"1540000\",\"6\":\"-1\",\"7\":\"72.842376\",\"8\":\"0.9990815\"},{\"1\":\"cuhre_0\",\"2\":\"3.906250e-04\",\"3\":\"1.0025837\",\"4\":\"3.916305e-04\",\"5\":\"21816795\",\"6\":\"39958\",\"7\":\"1796.986770\",\"8\":\"0.9999905\"},{\"1\":\"vegas\",\"2\":\"1.953125e-04\",\"3\":\"0.9992479\",\"4\":\"1.941853e-04\",\"5\":\"6201000\",\"6\":\"-1\",\"7\":\"263.328520\",\"8\":\"0.9949771\"},{\"1\":\"cuhre_0\",\"2\":\"1.953125e-04\",\"3\":\"1.0025392\",\"4\":\"1.958070e-04\",\"5\":\"43606563\",\"6\":\"79866\",\"7\":\"5933.400241\",\"8\":\"0.9999928\"},{\"1\":\"vegas\",\"2\":\"9.765625e-05\",\"3\":\"0.9992621\",\"4\":\"9.753200e-05\",\"5\":\"24570000\",\"6\":\"-1\",\"7\":\"1033.120339\",\"8\":\"0.9994652\"},{\"1\":\"cuhre_0\",\"2\":\"9.765625e-05\",\"3\":\"1.0011064\",\"4\":\"9.776397e-05\",\"5\":\"88914189\",\"6\":\"162847\",\"7\":\"28480.064155\",\"8\":\"0.9999966\"},{\"1\":\"vegas\",\"2\":\"4.882813e-05\",\"3\":\"0.9992546\",\"4\":\"4.872730e-05\",\"5\":\"98438500\",\"6\":\"-1\",\"7\":\"4152.248097\",\"8\":\"0.9986795\"},{\"1\":\"cuhre_0\",\"2\":\"4.882813e-05\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"100000173\",\"6\":\"183151\",\"7\":\"40849.683246\",\"8\":\"NA\"},{\"1\":\"vegas\",\"2\":\"2.441406e-05\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"100013500\",\"6\":\"-1\",\"7\":\"4287.831596\",\"8\":\"NA\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  \n\nAnalysis\nAs one measure of the innate “efficiency” of each algorithm, we consider how many function evaluations are required to obtain a given fractional error tolerance.\n\n\n\nFor this integrand, CUHRE always requires more function calls than does VEGAS. CUHRE with flag=0 requires far fewer function evaluations than it does with flag=4.\nCalculation time as a function of required error tolerance\n\n\n\nError estimate and function evaluations\n\n\n\nReliability of error estimate\nFor this integrand, we do not have knowledge of the correct answer; all we have are our numerical approximations. However, we can look at how the estimated value of the integral and its error estimate change as we change the fractional error tolerance. We do this only for algorithm runs that have claimed to converge.\n\n\n\nAll the results from the VEGAS algorithm are consistent with each other. The value seems to be converging to a value slightly less than 1.\nIn contrast, the results from the CUHRE algorithm with flag = 0 are not all consistent. This is an indication that the algorithm is underestimating its error.\nThe CUHRE algorithm with flag = 4 produced estimates that were consistent, but it was unable to converge within 100 million function evaluations for any but the loosest of error tolerances.\nError estimate as a function of running time\nUsers do not really care about the number of function evaluations done; they care about the time the algorithm takes to converge for a given error tolerance, and that the algorithm has actually converged to that tolerance.\n\n\n\nFor this integrand, the VEGAS algorithm is much faster than CUHRE. The CUHRE algorithm with flag = 0 is much faster than CURHE with flag = 4; but as we have seen above, the error estimate (and thus the convergence) may be unreliable.\n\n\n\n",
    "preview": "posts/2020-06-24-comparing-serial-vegas-and-cuhre-on-a-non-separable-integrand-part-2/comparing-serial-vegas-and-cuhre-on-a-non-separable-integrand-part-2_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2020-12-13T17:29:13-06:00",
    "input_file": {}
  },
  {
    "path": "posts/2020-06-24-comparing-serial-vegas-and-cuhre-on-a-non-separable-integrand/",
    "title": "Comparing serial VEGAS and CUHRE on a (partially) non-separable integrand",
    "description": "This document shows a comparison of the speed of the serial VEGAS and CUHRE\nalgorithms, as implemented in the CUBA (http://www.feynarts.de/cuba/) library,\nand wrapped by `cubacpp` (https://bitbucket.org/mpaterno/cubacpp), on a\nnon-separable integrand.\n\nNote this was updated on 2020-12-13.",
    "author": [
      {
        "name": "Marc Paterno",
        "url": "https://github.com/marcpaterno"
      }
    ],
    "date": "2020-06-24",
    "categories": [],
    "contents": "\nThe algorithms\nvegas is the Vegas algorithm of Lepage, as implemented in the CUBA library. This version uses quasi-random (low-descrepency sequence) numbers, rather than pseudo-random numbers. cuhre_0 is the serial CUHRE algorithm, as implemented in the CUBA library, using flag = 0. This version uses all the volumes produced by the algorithm for determining the final result. cuhre_1 is the serial CUHRE algorithm, as implemented in the CUBA library, using flag = 4. This version uses only the final set of volumes produced by the algorithm for determining the final result.\nThe integrand\nThe integrand chosen is: \\[ u \\, v + k \\frac{x \\, y \\, w^y}{1+u} +z^2 \\] with \\[k = \\frac{12}{7 - 6 (\\ln(2))^2 + \\ln(64)}\\].\nThe correct value of the integral is 1.\nTesting environment\nThese tests were run on a MacBook Pro laptop.\nThe MacBook machine used in these tests has a single 4-core 2.9 GHz Intel Core i7 processor.\n\nDescription of the dataframe\nalg: the name of the algorithm\nepsrel: the fractional error target\nvalue: the estimated value of the integral\nerrorest: the estimated error for the result\nerror: the absolute difference between the estimated value and the true value\nneval: the number of function evaluations used\nnregions: the number of regions used\ntime: the time in milliseconds for the calculation\nr: ratio of (errorest/(epsrel*value)); this should be less than 1 if the algorithm has converged\nconverged: boolean showing whether r < 1\nA value of NA indicates that the algorithm did not converge, but rather stopped because the maximum number of function evaluations had been reached.\n\n\n\n\n{\"columns\":[{\"label\":[\"alg\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"epsrel\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"value\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"errorest\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"error\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"neval\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"nregions\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"time\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"r\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"vegas\",\"2\":\"1.00000e-03\",\"3\":\"1.000225\",\"4\":\"9.519328e-04\",\"5\":\"2.254385e-04\",\"6\":\"45000\",\"7\":\"-1\",\"8\":\"3.393129\",\"9\":\"0.9517187\"},{\"1\":\"cuhre_0\",\"2\":\"1.00000e-03\",\"3\":\"1.000014\",\"4\":\"6.813956e-04\",\"5\":\"1.394056e-05\",\"6\":\"2265\",\"7\":\"3\",\"8\":\"0.142401\",\"9\":\"0.6813861\"},{\"1\":\"cuhre_1\",\"2\":\"1.00000e-03\",\"3\":\"1.000009\",\"4\":\"7.615604e-04\",\"5\":\"9.263730e-06\",\"6\":\"2265\",\"7\":\"3\",\"8\":\"0.140843\",\"9\":\"0.7615535\"},{\"1\":\"vegas\",\"2\":\"2.00000e-04\",\"3\":\"1.000028\",\"4\":\"1.981247e-04\",\"5\":\"2.766858e-05\",\"6\":\"976000\",\"7\":\"-1\",\"8\":\"54.990230\",\"9\":\"0.9905958\"},{\"1\":\"cuhre_0\",\"2\":\"2.00000e-04\",\"3\":\"1.000009\",\"4\":\"1.714239e-04\",\"5\":\"9.175899e-06\",\"6\":\"3171\",\"7\":\"4\",\"8\":\"0.181561\",\"9\":\"0.8571118\"},{\"1\":\"cuhre_1\",\"2\":\"2.00000e-04\",\"3\":\"1.000009\",\"4\":\"1.771206e-04\",\"5\":\"8.853961e-06\",\"6\":\"3171\",\"7\":\"4\",\"8\":\"0.176426\",\"9\":\"0.8855950\"},{\"1\":\"vegas\",\"2\":\"4.00000e-05\",\"3\":\"1.000002\",\"4\":\"3.996686e-05\",\"5\":\"2.182901e-06\",\"6\":\"23947000\",\"7\":\"-1\",\"8\":\"1158.472000\",\"9\":\"0.9991695\"},{\"1\":\"cuhre_0\",\"2\":\"4.00000e-05\",\"3\":\"1.000002\",\"4\":\"3.321969e-05\",\"5\":\"1.895981e-06\",\"6\":\"6795\",\"7\":\"8\",\"8\":\"0.279701\",\"9\":\"0.8304906\"},{\"1\":\"cuhre_1\",\"2\":\"4.00000e-05\",\"3\":\"1.000001\",\"4\":\"3.402270e-05\",\"5\":\"8.177256e-07\",\"6\":\"7701\",\"7\":\"9\",\"8\":\"0.276971\",\"9\":\"0.8505666\"},{\"1\":\"vegas\",\"2\":\"8.00000e-06\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4793.098000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"8.00000e-06\",\"3\":\"1.000001\",\"4\":\"7.077168e-06\",\"5\":\"6.572862e-07\",\"6\":\"10419\",\"7\":\"12\",\"8\":\"0.556433\",\"9\":\"0.8846451\"},{\"1\":\"cuhre_1\",\"2\":\"8.00000e-06\",\"3\":\"1.000000\",\"4\":\"7.518407e-06\",\"5\":\"4.231055e-07\",\"6\":\"11325\",\"7\":\"13\",\"8\":\"1.021254\",\"9\":\"0.9398009\"},{\"1\":\"vegas\",\"2\":\"1.60000e-06\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4757.160000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"1.60000e-06\",\"3\":\"1.000000\",\"4\":\"1.538230e-06\",\"5\":\"1.955625e-07\",\"6\":\"15855\",\"7\":\"18\",\"8\":\"0.792560\",\"9\":\"0.9613938\"},{\"1\":\"cuhre_1\",\"2\":\"1.60000e-06\",\"3\":\"1.000000\",\"4\":\"1.558443e-06\",\"5\":\"5.951059e-08\",\"6\":\"18573\",\"7\":\"21\",\"8\":\"1.113204\",\"9\":\"0.9740269\"},{\"1\":\"vegas\",\"2\":\"3.20000e-07\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4777.543000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"3.20000e-07\",\"3\":\"1.000000\",\"4\":\"2.900560e-07\",\"5\":\"2.725430e-08\",\"6\":\"24009\",\"7\":\"27\",\"8\":\"1.717430\",\"9\":\"0.9064250\"},{\"1\":\"cuhre_1\",\"2\":\"3.20000e-07\",\"3\":\"1.000000\",\"4\":\"2.544270e-07\",\"5\":\"2.755300e-10\",\"6\":\"28539\",\"7\":\"32\",\"8\":\"1.189648\",\"9\":\"0.7950844\"},{\"1\":\"vegas\",\"2\":\"6.40000e-08\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4834.965000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"6.40000e-08\",\"3\":\"1.000000\",\"4\":\"5.734008e-08\",\"5\":\"6.350508e-10\",\"6\":\"33975\",\"7\":\"38\",\"8\":\"1.827232\",\"9\":\"0.8959388\"},{\"1\":\"cuhre_1\",\"2\":\"6.40000e-08\",\"3\":\"1.000000\",\"4\":\"6.290317e-08\",\"5\":\"4.330500e-10\",\"6\":\"40317\",\"7\":\"45\",\"8\":\"1.613739\",\"9\":\"0.9828620\"},{\"1\":\"vegas\",\"2\":\"1.28000e-08\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4794.098000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"1.28000e-08\",\"3\":\"1.000000\",\"4\":\"1.244865e-08\",\"5\":\"1.854634e-10\",\"6\":\"47565\",\"7\":\"53\",\"8\":\"2.124509\",\"9\":\"0.9725508\"},{\"1\":\"cuhre_1\",\"2\":\"1.28000e-08\",\"3\":\"1.000000\",\"4\":\"1.263798e-08\",\"5\":\"3.263738e-10\",\"6\":\"58437\",\"7\":\"65\",\"8\":\"2.285813\",\"9\":\"0.9873422\"},{\"1\":\"vegas\",\"2\":\"2.56000e-09\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4773.896000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"2.56000e-09\",\"3\":\"1.000000\",\"4\":\"2.484014e-09\",\"5\":\"7.028622e-11\",\"6\":\"66591\",\"7\":\"74\",\"8\":\"3.569959\",\"9\":\"0.9703180\"},{\"1\":\"cuhre_1\",\"2\":\"2.56000e-09\",\"3\":\"1.000000\",\"4\":\"2.504138e-09\",\"5\":\"7.034595e-12\",\"6\":\"86523\",\"7\":\"96\",\"8\":\"3.963880\",\"9\":\"0.9781789\"},{\"1\":\"vegas\",\"2\":\"5.12000e-10\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4821.614000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"5.12000e-10\",\"3\":\"1.000000\",\"4\":\"4.985302e-10\",\"5\":\"2.541889e-11\",\"6\":\"96489\",\"7\":\"107\",\"8\":\"4.011069\",\"9\":\"0.9736918\"},{\"1\":\"cuhre_1\",\"2\":\"5.12000e-10\",\"3\":\"1.000000\",\"4\":\"4.957671e-10\",\"5\":\"1.985290e-11\",\"6\":\"130011\",\"7\":\"144\",\"8\":\"4.597543\",\"9\":\"0.9682951\"},{\"1\":\"vegas\",\"2\":\"1.02400e-10\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4783.356000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"1.02400e-10\",\"3\":\"1.000000\",\"4\":\"1.023238e-10\",\"5\":\"2.040867e-11\",\"6\":\"135447\",\"7\":\"150\",\"8\":\"5.817229\",\"9\":\"0.9992559\"},{\"1\":\"cuhre_1\",\"2\":\"1.02400e-10\",\"3\":\"1.000000\",\"4\":\"1.015635e-10\",\"5\":\"1.482259e-12\",\"6\":\"198867\",\"7\":\"220\",\"8\":\"7.330228\",\"9\":\"0.9918311\"},{\"1\":\"vegas\",\"2\":\"2.04800e-11\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4791.974000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"2.04800e-11\",\"3\":\"1.000000\",\"4\":\"2.033960e-11\",\"5\":\"4.260037e-12\",\"6\":\"195243\",\"7\":\"216\",\"8\":\"7.502347\",\"9\":\"0.9931445\"},{\"1\":\"cuhre_1\",\"2\":\"2.04800e-11\",\"3\":\"1.000000\",\"4\":\"2.031308e-11\",\"5\":\"3.832490e-13\",\"6\":\"321177\",\"7\":\"355\",\"8\":\"11.755150\",\"9\":\"0.9918496\"},{\"1\":\"vegas\",\"2\":\"4.09600e-12\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4788.287000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"4.09600e-12\",\"3\":\"1.000000\",\"4\":\"4.088238e-12\",\"5\":\"6.651346e-13\",\"6\":\"298527\",\"7\":\"330\",\"8\":\"12.371700\",\"9\":\"0.9981050\"},{\"1\":\"cuhre_1\",\"2\":\"4.09600e-12\",\"3\":\"1.000000\",\"4\":\"4.084685e-12\",\"5\":\"7.127632e-14\",\"6\":\"533181\",\"7\":\"589\",\"8\":\"20.698880\",\"9\":\"0.9972375\"},{\"1\":\"vegas\",\"2\":\"8.19200e-13\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4809.726000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"8.19200e-13\",\"3\":\"1.000000\",\"4\":\"8.173652e-13\",\"5\":\"3.498313e-13\",\"6\":\"451641\",\"7\":\"499\",\"8\":\"18.394600\",\"9\":\"0.9977603\"},{\"1\":\"cuhre_1\",\"2\":\"8.19200e-13\",\"3\":\"1.000000\",\"4\":\"8.188788e-13\",\"5\":\"2.309264e-14\",\"6\":\"933633\",\"7\":\"1031\",\"8\":\"36.352260\",\"9\":\"0.9996079\"},{\"1\":\"vegas\",\"2\":\"1.63840e-13\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4832.437000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"1.63840e-13\",\"3\":\"1.000000\",\"4\":\"1.631906e-13\",\"5\":\"3.896883e-14\",\"6\":\"719817\",\"7\":\"795\",\"8\":\"30.812130\",\"9\":\"0.9960364\"},{\"1\":\"cuhre_1\",\"2\":\"1.63840e-13\",\"3\":\"1.000000\",\"4\":\"1.637455e-13\",\"5\":\"8.437695e-15\",\"6\":\"1633065\",\"7\":\"1803\",\"8\":\"69.948500\",\"9\":\"0.9994232\"},{\"1\":\"vegas\",\"2\":\"3.27680e-14\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4832.379000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"3.27680e-14\",\"3\":\"1.000000\",\"4\":\"3.276105e-14\",\"5\":\"2.065015e-14\",\"6\":\"1158321\",\"7\":\"1279\",\"8\":\"46.101100\",\"9\":\"0.9997879\"},{\"1\":\"cuhre_1\",\"2\":\"3.27680e-14\",\"3\":\"1.000000\",\"4\":\"3.275867e-14\",\"5\":\"7.771561e-15\",\"6\":\"2813583\",\"7\":\"3106\",\"8\":\"112.164400\",\"9\":\"0.9997153\"},{\"1\":\"vegas\",\"2\":\"6.55360e-15\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4787.725000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"6.55360e-15\",\"3\":\"1.000000\",\"4\":\"6.552135e-15\",\"5\":\"9.325873e-15\",\"6\":\"1852317\",\"7\":\"2045\",\"8\":\"72.830140\",\"9\":\"0.9997765\"},{\"1\":\"cuhre_1\",\"2\":\"6.55360e-15\",\"3\":\"1.000000\",\"4\":\"6.550725e-15\",\"5\":\"7.771561e-15\",\"6\":\"5208141\",\"7\":\"5749\",\"8\":\"226.911500\",\"9\":\"0.9995613\"},{\"1\":\"vegas\",\"2\":\"1.31072e-15\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4808.972000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"1.31072e-15\",\"3\":\"1.000000\",\"4\":\"1.310385e-15\",\"5\":\"6.883383e-15\",\"6\":\"2961261\",\"7\":\"3269\",\"8\":\"119.412800\",\"9\":\"0.9997444\"},{\"1\":\"cuhre_1\",\"2\":\"1.31072e-15\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100000203\",\"7\":\"110376\",\"8\":\"15449.300000\",\"9\":\"NA\"},{\"1\":\"vegas\",\"2\":\"2.62144e-16\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4806.762000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"2.62144e-16\",\"3\":\"1.000000\",\"4\":\"2.620167e-16\",\"5\":\"6.772360e-15\",\"6\":\"4852989\",\"7\":\"5357\",\"8\":\"202.735400\",\"9\":\"0.9995144\"},{\"1\":\"cuhre_1\",\"2\":\"2.62144e-16\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100000203\",\"7\":\"110376\",\"8\":\"15828.560000\",\"9\":\"NA\"},{\"1\":\"vegas\",\"2\":\"5.24288e-17\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100013500\",\"7\":\"-1\",\"8\":\"4780.094000\",\"9\":\"NA\"},{\"1\":\"cuhre_0\",\"2\":\"5.24288e-17\",\"3\":\"1.000000\",\"4\":\"5.242788e-17\",\"5\":\"7.771561e-15\",\"6\":\"8833953\",\"7\":\"9751\",\"8\":\"395.168300\",\"9\":\"0.9999825\"},{\"1\":\"cuhre_1\",\"2\":\"5.24288e-17\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"100000203\",\"7\":\"110376\",\"8\":\"15658.750000\",\"9\":\"NA\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  \n\nAnalysis\nAs one measure of the innate “efficiency” of each algorithm, we consider how many function evaluations are required to obtain a given fractional error tolerance.\n\n\n\nFor this integrand, VEGAS always requires more function calls than does CUHRE. CUHRE with flag=0 requires fewer function evaluations than it does with flag=4.\nCalculation time as a function of required error tolerance\n\n\n\nError estimate and function evaluations\n\n\n\nReliability of error estimate\nIf we look only at the calculations that converged, how accurate are the error estimates?\n\n\n\nIf the error estimate is reliable, then the ratio should not exceed 1. At the most stringent (fractional) error tolerances, the error estimate from the CUHRE algorithm with flag=0 are not reliable. That is, the algorithm is claiming to have converged when it actually has not converged.\nError estimate as a function of running time\nUsers do not really care about the number of function evaluations done; they care about the time the algorithm takes to converge for a given error tolerance, and that the algorithm has actually converged to that tolerance.\n\n\n\nFor this integrand, the CUHRE algorithm is much faster than VEGAS. The CUHRE algorithm with flag = 0 is faster for large error tolerances, but as we have seen above, the error estimate (and thus the convergence) becomes unreliable. Since in real problems the user would not know the value of the integral (or they would not be using a numerical approximation method!), it seems prudent to use the algorithm with flag = 4 – at least for this integrand.\n\n\n\n",
    "preview": "posts/2020-06-24-comparing-serial-vegas-and-cuhre-on-a-non-separable-integrand/comparing-serial-vegas-and-cuhre-on-a-non-separable-integrand_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2020-12-13T17:29:20-06:00",
    "input_file": {}
  },
  {
    "path": "posts/2020-06-10-where-serial-cuhre-evaluates-functions/",
    "title": "Where serial CUHRE evaluates functions",
    "description": "A visualization of where CUHRE evaluates functions for a 2-dimensional integrand.",
    "author": [
      {
        "name": "Marc Paterno",
        "url": "https://github.com/marcpaterno"
      }
    ],
    "date": "2020-06-10",
    "categories": [],
    "contents": "\nThis document shows where the serial CUHRE algorithm evaluates the function it is integrating. Unlike a Monte Carlo algorithm (such as VEGAS), CUHRE evaluates the function at a set of deterministically chosen points.\nThe function used as the integrand in this example is:\n\\[ 2 x^2 + 2 y - y^2.\\] We have used both VEGAS and CUHRE to integrate this function, using a fractional error tolerance of 0.01. The large fractional error was chosen to limit the number of function evaluations. This function is sufficiently simple that CUHRE uses only two regions. The plots show where VEGAS and CUHRE each evaluate the function to achieve this level of accuracy.\n\n\n\nVEGAS required 2500 function evaluations, and CUHRE required 195.\n\n\n\n\n\n\n",
    "preview": "posts/2020-06-10-where-serial-cuhre-evaluates-functions/where-serial-cuhre-evaluates-functions_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2020-12-11T15:26:19-06:00",
    "input_file": {}
  },
  {
    "path": "posts/2020-06-08-the-genz-function-1-in-8d/",
    "title": "The Genz function 1 in 8d",
    "description": "This document shows a performance comparison between the serial\nand parallel implementations of the CUHRE algorithm for a\nnon-positive-definite integrand.",
    "author": [
      {
        "name": "Marc Paterno",
        "url": "https://github.com/marcpaterno"
      }
    ],
    "date": "2020-06-08",
    "categories": [],
    "contents": "\nThe integrand\nThe integrand chosen is: \\[ \\cos(s + 2 t + 3 u +4 w +5 w + 6 x +7 y + 8 z) / k\\] with \\[ k = (1/315)  \\sin(1)  \\sin(3/2) \\sin(2) \\sin(5/2) \\sin(3) \n       \\sin(7/2) \\sin(4) (\\sin(37/2) - \\sin(35/2)). \\]\n\\(k\\) is approximately equal to 3.43955795218325e-05.\nTesting environment\nThese tests were run on ibmpower9.fnal.gov.\nThe Power9 machine used in these tests is a PowerNV 8335-GTG (AC 922) system. It has two processors, each with 8 cores. Each core has 4 slices.\n\nDescription of the dataframe\nalg: the name of the algorithm\nepsrel: the fractional error target\nvalue: the estimated value of the integral\nerrorest: the estimated error for the result\nerror: the absolute difference between the estimated value and the true value\nneval: the number of function evaluations used\nnregions: the number of regions used\ntime: the time in milliseconds for the calculation\nr: ratio of (errorest/(epsrel*value)); this should be less than 1 if the algorithm has converged\nconverged: boolean showing whether r < 1\nA value of NA indicates that the algorithm did not converge, but rather stopped because the maximum number of function evaluations had been reached.\n\n\nalg\nepsrel\nvalue\nerrorest\nerror\nneval\nnregions\ntime\nr\ncuhre\n1.00e-03\n0.9999127\n0.0009999\n8.73e-05\n48526075\n21958\n26820.71\n0.9999513\ncuhre\n5.00e-04\n1.0000750\n0.0005000\n7.51e-05\n79205295\n35840\n44249.74\n0.9999650\ncuhre\n2.50e-04\n1.0000490\n0.0002500\n4.89e-05\n124311395\n56250\n70582.94\n0.9999806\ncuhre\n1.25e-04\n1.0000140\n0.0001250\n1.36e-05\n202753135\n91744\n121709.60\n0.9999916\ncuhre\n6.25e-05\n1.0000040\n0.0000625\n4.10e-06\n335613915\n151862\n230264.20\n0.9999955\ncuhre\n3.12e-05\n1.0000010\n0.0000312\n1.50e-06\n548874495\n248360\n451179.80\n0.9999961\ncuhre\n1.56e-05\n0.9999997\n0.0000156\n3.00e-07\n882520405\n399331\n935296.90\n0.9999971\ncuhre\n7.80e-06\n1.0000010\n0.0000078\n9.00e-07\n1388581675\n628318\n2060807.00\n0.9999987\ncuhre\n3.90e-06\n1.0000000\n0.0000039\n2.00e-07\n2117439675\n958118\n4446506.00\n0.9999990\ncuhre\n2.00e-06\n1.0000000\n0.0000020\n2.00e-07\n3294176275\n1490578\n10027550.00\n0.9999995\n\nAnalysis\nWe do not yet have results from the parallel algorithm. These results are from the serial algorithm.\nBecause the range of fractional error tolerance values is large, and the range of times is very large, we use log scales for our plot. The line is a fitted linear model; the fit is clearly poor.\n\n\n\nThe number of regions needed to obtain a given fractional error tolerance seems to be related in a power law to the reciprocal of the fractional error tolerance.\n\n\n\n\n\n\n",
    "preview": "posts/2020-06-08-the-genz-function-1-in-8d/the-genz-function-1-in-8d_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2020-12-11T15:30:34-06:00",
    "input_file": {}
  },
  {
    "path": "posts/2020-06-06-welcome-to-the-blog/",
    "title": "Welcome to the blog",
    "description": "Welcome to our new blog, GPU Integration Notes.",
    "author": [
      {
        "name": "Marc Paterno",
        "url": "https://github.com/marcpaterno"
      }
    ],
    "date": "2020-06-06",
    "categories": [],
    "contents": "\nThis will be the place where we post articles describing the work on our laboratory-directed research and development project “Numerical Integration on GPUs” (LDRD-2020-050). This project is supported by the Fermi National Accelerator Laboratory’s LDRD program.\nThe research is being conducted by:\nDr. Marc Paterno (Fermi National Accelerator Laboratory)\nIoannis Sakiotis (Old Dominion University)\nProf. Desh Ranjan (Old Dominion University)\nProf. Balsa Terzoc (Old Dominion University)\nProf. Mohammad Zubair (Old Dominion University)\n\n\n\n",
    "preview": {},
    "last_modified": "2020-12-10T11:54:37-06:00",
    "input_file": {}
  }
]
